function sort(t,e,r=!1){return t.sort(((t,a)=>{const o=Number(`${t[e]}`.match(/\d+/g)),i=Number(`${a[e]}`.match(/\d+/g));return o>i?r?1:-1:i>o?r?-1:1:0}))}function wordCommit(t,e){const r=Math.abs(t)%100,a=Math.abs(t)%10;return r>10&&r<20?e[2]:a>1&&a<5?e[1]:1==a?e[0]:e[2]}function commitsOfSprint(t,e,r){return t.filter((t=>{const{timestamp:a}=t;return e<=a&&a<=r}))}function commitsGroupBySize(t,e){return t.reduce(((t,r)=>{const{summaries:a}=r,o=e.filter((t=>a.includes(t.id))).map((t=>t.added+t.removed)).reduce(((t,e)=>t+e),0);switch(!0){case o>1001:++t["> 1001 ÑÑ‚Ñ€Ð¾ÐºÐ¸"];break;case o>500&&o<=1e3:++t["501 â€” 1000 ÑÑ‚Ñ€Ð¾Ðº"];break;case o>100&&o<=500:++t["101 â€” 500 ÑÑ‚Ñ€Ð¾Ðº"];break;case o>=1&&o<=100:++t["1 â€” 100 ÑÑ‚Ñ€Ð¾Ðº"]}return t}),{"> 1001 ÑÑ‚Ñ€Ð¾ÐºÐ¸":0,"501 â€” 1000 ÑÑ‚Ñ€Ð¾Ðº":0,"101 â€” 500 ÑÑ‚Ñ€Ð¾Ðº":0,"1 â€” 100 ÑÑ‚Ñ€Ð¾Ðº":0,countCommits:t.length})}function renderCategory(t,e){const r=e[1][t],a=e[0][t];return{title:t,valueText:`${r} ${wordCommit(r,["ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚","ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð°","ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¾Ð²"])}`,differenceText:`${r-a} ${wordCommit(r-a,["ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚","ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð°","ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¾Ð²"])}`}}function prepareData(t,{sprintId:e}){const r=t.find((t=>t.id===e)),{name:a,startAt:o,finishAt:i}=r;console.log(r);let[n,s,u,m,c]=[[],[],[],[],[]];t.forEach((t=>{const{type:e,createdAt:r,author:a,summaries:d}=t;"User"===e&&n.push(t),"Sprint"===e&&s.push(t),"Comment"===e&&o<=r&&r<=i&&(t.author="object"==typeof a?a.id:a,u.push(t)),"Commit"===e&&(t.author="object"==typeof a?a.id:a,t.summaries=d.map((t=>"object"==typeof t?t.id:t)),m.push(t)),"Summary"===e&&c.push(t)})),s=sort(s,"id",!0),n=sort(n,"id",!0);const d=u.reduce(((t,e)=>{let{author:r,likes:a}=e;return a&&(t[r]=(t[r]?t[r]:0)+a.length),t}),{}),l={alias:"vote",data:{title:"Ð¡Ð°Ð¼Ñ‹Ð¹ Ð²Ð½Ð¸Ð¼Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº",subtitle:a,emoji:"ðŸ”Ž",users:sort(n.map((t=>{const{id:e,name:r,avatar:a}=t;return{id:e,name:r,avatar:a,valueText:`${d[e]} Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²`}})),"valueText")}},p=commitsOfSprint(m,o,i),h=p.reduce(((t,e)=>{let{author:r}=e;return t[r]=(t[r]?t[r]:0)+1,t}),{}),f=n.map((t=>{const{id:e,name:r,avatar:a}=t;return{id:e,name:r,avatar:a,valueText:`${h[e]}`}})),b={alias:"leaders",data:{title:"Ð‘Ð¾Ð»ÑŒÑˆÐµ Ð²ÑÐµÐ³Ð¾ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¾Ð²",subtitle:a,emoji:"ðŸ‘‘",users:sort(f,"valueText")}},v={alias:"chart",data:{title:"ÐšÐ¾Ð¼Ð¼Ð¸Ñ‚Ñ‹",subtitle:a,values:s.map((t=>{const{id:r,name:a,startAt:o,finishAt:i}=t,n=r===e?{active:!0}:{};return{id:r,hint:a,valueText:`${commitsOfSprint(m,o,i).length}`,...n}})),users:sort(f,"valueText")}},C=s.findIndex((t=>t.id===e)),g=[s[C-1],r].reduce(((t,e)=>{const{startAt:r,finishAt:a}=e;return[...t,commitsGroupBySize(commitsOfSprint(m,r,a),c)]}),[]),y=g[1].countCommits,x=g[1].countCommits-g[0].countCommits;return[l,b,v,{alias:"diagram",data:{title:"Ð Ð°Ð·Ð¼ÐµÑ€ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¾Ð²",subtitle:a,totalText:`${y} ${wordCommit(y,["ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚","ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð°","ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¾Ð²"])}`,differenceText:`${x} Ñ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾Ð³Ð¾ ÑÐ¿Ñ€Ð¸Ð½Ñ‚Ð°`,categories:[renderCategory("> 1001 ÑÑ‚Ñ€Ð¾ÐºÐ¸",g),renderCategory("501 â€” 1000 ÑÑ‚Ñ€Ð¾Ðº",g),renderCategory("101 â€” 500 ÑÑ‚Ñ€Ð¾Ðº",g),renderCategory("1 â€” 100 ÑÑ‚Ñ€Ð¾Ðº",g)]}},{alias:"activity",data:{title:"ÐšÐ¾Ð¼Ð¼Ð¸Ñ‚Ñ‹",subtitle:a,data:p.reduce(((t,e)=>{const{timestamp:r}=e,a=new Date(r),o=a.toLocaleString("en",{weekday:"short",timeZone:"Europe/Moscow"}).toLowerCase(),i=Number(a.toLocaleString("en",{hour12:!1,hour:"numeric",timeZone:"Europe/Moscow"}));return t[o][i]=t[o][i]?++t[o][i]:1,t}),{sun:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],mon:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],tue:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],wed:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],thu:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fri:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],sat:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]})}}]}module.exports={prepareData};